<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>QuickTools.in - Simple PDF Split</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
</head>
<body class="bg-sky-50 min-h-screen p-6 md:p-10">
<div class="max-w-3xl mx-auto">
  <h1 class="text-4xl font-black text-center mb-4 bg-gradient-to-r from-indigo-600 to-sky-600 bg-clip-text text-transparent">
   ‚úÇÔ∏è Simple PDF Splitter
  </h1>
  <p class="text-center text-lg text-gray-600 mb-8">
    Upload 1 PDF ‚Üí choose pages ‚Üí download only those pages.
  </p>

  <!-- Upload -->
  <div class="bg-white rounded-3xl shadow-2xl border-4 border-dashed border-indigo-200 p-10 text-center cursor-pointer mb-8"
       id="uploadBox">
    <input id="fileInput" type="file" accept="application/pdf" class="hidden">
    <div class="text-6xl mb-4">üìÑ</div>
    <p class="text-xl font-bold text-gray-700 mb-1">CLICK HERE to choose a PDF</p>
    <p class="text-sm text-gray-500">Then select page range like 1-3 or 5</p>
  </div>

  <!-- File info -->
  <div id="fileInfo" class="hidden bg-white rounded-3xl shadow-xl p-6 mb-8">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
      <div>
        <p class="text-sm font-semibold text-gray-800" id="fileName">-</p>
        <p class="text-xs text-gray-500" id="fileSize">-</p>
      </div>
      <button id="clearBtn"
              class="self-start md:self-auto bg-red-100 hover:bg-red-200 text-red-700 px-4 py-2 rounded-xl text-xs font-semibold">
        üßπ Clear file
      </button>
    </div>
    <p class="mt-2 text-xs text-gray-500" id="pageInfo">Pages: unknown</p>
  </div>

  <!-- Controls -->
  <div id="controls" class="hidden bg-white rounded-3xl shadow-xl p-6 mb-8">
    <p class="text-sm text-gray-600 mb-2">
      Example: <span class="font-semibold">1-3</span> (pages 1,2,3) or <span class="font-semibold">5</span> (only page 5).
    </p>
    <div class="flex flex-col md:flex-row gap-3 items-center">
      <input id="rangeInput" type="text"
             placeholder="1-3 or 5"
             class="flex-1 p-3 border-2 border-gray-200 rounded-2xl focus:border-indigo-500 outline-none text-sm">
      <button id="splitBtn"
              class="md:w-40 bg-gradient-to-r from-indigo-600 to-blue-600 text-white py-3 text-sm font-bold rounded-2xl shadow-lg hover:shadow-xl disabled:opacity-40"
              disabled>
        ‚úÇÔ∏è Split
      </button>
    </div>
  </div>

  <!-- Status -->
  <div id="status" class="hidden text-center mb-6">
    <div class="flex items-center justify-center gap-3 text-indigo-700">
      <div class="w-6 h-6 border-4 border-indigo-200 border-t-indigo-600 rounded-full animate-spin"></div>
      <span class="font-semibold text-sm" id="statusText">Processing...</span>
    </div>
  </div>

  <!-- Result -->
  <div id="result" class="hidden bg-white rounded-3xl shadow-xl p-6 text-center">
    <p class="text-lg font-bold text-emerald-600 mb-2">‚úÖ Split ready</p>
    <p class="text-xs text-gray-600 mb-4" id="resultInfo">Your new PDF is ready.</p>
    <button id="downloadBtn"
            class="w-full bg-gradient-to-r from-emerald-600 to-teal-600 text-white py-4 text-base font-bold rounded-2xl shadow-lg hover:shadow-xl">
      üíæ Download split PDF
    </button>
  </div>
</div>

<script>
const { PDFDocument } = PDFLib;

const uploadBox = document.getElementById('uploadBox');
const fileInput = document.getElementById('fileInput');
const fileInfo = document.getElementById('fileInfo');
const fileNameEl = document.getElementById('fileName');
const fileSizeEl = document.getElementById('fileSize');
const pageInfoEl = document.getElementById('pageInfo');
const clearBtn = document.getElementById('clearBtn');
const controls = document.getElementById('controls');
const rangeInput = document.getElementById('rangeInput');
const splitBtn = document.getElementById('splitBtn');
const statusBox = document.getElementById('status');
const statusText = document.getElementById('statusText');
const resultBox = document.getElementById('result');
const resultInfo = document.getElementById('resultInfo');
const downloadBtn = document.getElementById('downloadBtn');

let currentFile = null;
let totalPages = 0;
let splitBytes = null;

// Click to open chooser
uploadBox.addEventListener('click', () => fileInput.click());

// When user picks a file
fileInput.addEventListener('change', () => {
  const file = fileInput.files[0];
  handleFile(file);
});

function handleFile(file) {
  if (!file) return;
  if (file.type !== 'application/pdf') {
    alert('Please select a PDF file (.pdf)');
    return;
  }
  currentFile = file;
  splitBytes = null;
  resultBox.classList.add('hidden');
  controls.classList.add('hidden');

  // Show basic info
  fileInfo.classList.remove('hidden');
  fileNameEl.textContent = file.name;
  fileSizeEl.textContent = (file.size / 1024).toFixed(1) + ' KB';

  // Read page count
  statusBox.classList.remove('hidden');
  statusText.textContent = 'Reading PDF pages...';

  file.arrayBuffer().then(async (buf) => {
    try {
      const pdf = await PDFDocument.load(buf);
      totalPages = pdf.getPageCount();
      pageInfoEl.textContent = 'Pages detected: ' + totalPages;
      controls.classList.remove('hidden');
      statusBox.classList.add('hidden');
    } catch (e) {
      console.error(e);
      statusBox.classList.add('hidden');
      alert('Could not read this PDF. Try another file.');
    }
  });
}

// Clear
clearBtn.addEventListener('click', () => {
  currentFile = null;
  totalPages = 0;
  splitBytes = null;
  fileInput.value = '';
  fileInfo.classList.add('hidden');
  controls.classList.add('hidden');
  resultBox.classList.add('hidden');
  statusBox.classList.add('hidden');
});

// Enable button when text entered
rangeInput.addEventListener('input', () => {
  splitBtn.disabled = !rangeInput.value.trim();
});

// Parse range like "1-3" or "5"
function parseRange(str) {
  const txt = str.trim();
  if (!txt) return null;
  if (txt.includes('-')) {
    const parts = txt.split('-').map(s => s.trim());
    const s = parseInt(parts[0], 10);
    const e = parseInt(parts[1], 10);
    if (!s || !e || s < 1 || e < s) return null;
    return { start: s, end: e };
  } else {
    const p = parseInt(txt, 10);
    if (!p || p < 1) return null;
    return { start: p, end: p };
  }
}

// Split
splitBtn.addEventListener('click', async () => {
  if (!currentFile || !totalPages) {
    alert('Please select a PDF first.');
    return;
  }
  const range = parseRange(rangeInput.value);
  if (!range) {
    alert('Enter a valid page or range like "1-3" or "5".');
    return;
  }
  if (range.end > totalPages) {
    alert('PDF has only ' + totalPages + ' pages.');
    return;
  }

  statusBox.classList.remove('hidden');
  statusText.textContent = 'Extracting pages ' + range.start + '-' + range.end + '...';
  resultBox.classList.add('hidden');

  try {
    const buf = await currentFile.arrayBuffer();
    const srcPdf = await PDFDocument.load(buf);
    const newPdf = await PDFDocument.create();

    const indices = [];
    for (let i = range.start; i <= range.end; i++) {
      indices.push(i - 1);
    }

    const copied = await newPdf.copyPages(srcPdf, indices);
    copied.forEach(p => newPdf.addPage(p));

    splitBytes = await newPdf.save();

    const count = range.end - range.start + 1;
    resultInfo.textContent = 'Extracted ' + count + ' page(s): ' + range.start + '-' + range.end + '.';
    statusBox.classList.add('hidden');
    resultBox.classList.remove('hidden');
  } catch (e) {
    console.error(e);
    statusBox.classList.add('hidden');
    alert('Splitting failed. Try a smaller range or different PDF.');
  }
});

// Download
downloadBtn.addEventListener('click', () => {
  if (!splitBytes) return;
  const blob = new Blob([splitBytes], { type: 'application/pdf' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  const nameRange = rangeInput.value.trim().replace(/\s+/g, '');
  a.href = url;
  a.download = 'split-' + (nameRange || 'pages') + '.pdf';
  a.click();
  URL.revokeObjectURL(url);
});
</script>
</body>
</html>
